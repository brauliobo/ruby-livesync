#!/usr/bin/env ruby

require_relative '../lib/ruby-livesync'

path  = ARGV[0]
meth  = ENV['METH']&.to_sym || :watch
modes = ENV['MODES']&.split(',')&.map(&:to_sym)
klass = if ENV['REMOTE'] then LiveSync::RemoteWatcher else LiveSync::Watcher end
klass.new.send meth, path, *modes do |event|
  puts "#{event.absolute_name}: #{event.flags}"
end.run

